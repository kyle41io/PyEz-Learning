{% load i18n %}

<!-- Quiz Intro Screen -->
<div id="{{ component_id }}-intro" class="h-full flex flex-col items-center justify-center">
  <div class="text-center max-w-2xl mx-auto p-8">
    <div class="mb-6">
      <i class="fa-solid fa-clipboard-question text-6xl text-primary"></i>
    </div>
    <h3 class="text-3xl font-bold mb-4">{{ title }}</h3>
    {% if description %}
    <p class="text-gray-600 dark:text-gray-400 mb-6">{{ description }}</p>
    {% endif %}
    <div class="bg-gray-50 dark:bg-gray-700 rounded-xl p-6 mb-6">
      <div class="grid grid-cols-2 gap-4">
        <div class="text-center">
          <div class="text-3xl font-bold text-primary">{{ quiz_data|length }}</div>
          <div class="text-sm text-gray-600 dark:text-gray-400">{% trans "Questions" %}</div>
        </div>
        <div class="text-center">
          <div class="text-3xl font-bold text-primary">{{ points_value }}</div>
          <div class="text-sm text-gray-600 dark:text-gray-400">{% trans "Max Stars" %} <i class="fa-sharp fa-solid fa-star text-yellow-400"></i></div>
        </div>
      </div>
    </div>
    <div class="flex justify-center">
      <button onclick="{{ on_start }}" class="px-8 py-3 bg-primary text-white rounded-xl font-bold hover:opacity-90 transition">
        <i class="fa-solid fa-play mr-2"></i>{% trans "Start Test" %}
      </button>
    </div>
  </div>
</div>

<!-- Quiz Content -->
<div id="{{ component_id }}-content" class="hidden h-full overflow-y-auto">
  <div class="max-w-4xl mx-auto">
    <div class="sticky top-0 bg-surface border-b border-gray-200 dark:border-gray-700 p-4 mb-6 rounded-xl shadow-sm z-10">
      <div class="flex justify-between items-center">
        <div>
          <span class="text-sm text-gray-600 dark:text-gray-400">{% trans "Progress" %}:</span>
          <span class="font-bold text-primary"><span id="{{ component_id }}-answered-count">0</span>/{{ quiz_data|length }}</span>
        </div>
        <button id="{{ component_id }}-submit-btn" onclick="{{ on_submit }}" disabled 
          class="px-6 py-2 bg-primary text-white rounded-xl font-bold hover:opacity-90 transition disabled:opacity-50 disabled:cursor-not-allowed">
          <i class="fa-solid fa-paper-plane mr-2"></i>{% trans "Submit Test" %}
        </button>
      </div>
    </div>

    <div class="space-y-6 pb-8">
      {% for question in quiz_data %}
      <div class="bg-surface p-6 rounded-xl shadow-md" data-question-id="{{ question.id }}">
        <div class="flex items-start mb-4">
          <span class="flex-shrink-0 w-8 h-8 bg-primary text-white rounded-full flex items-center justify-center font-bold mr-3">
            {{ forloop.counter }}
          </span>
          <h4 class="text-lg font-bold flex-grow">{{ question.question }}</h4>
        </div>
        <div class="space-y-3 ml-11">
          {% for option in question.options %}
          <label class="flex items-center p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition">
            <input type="radio" name="question_{{ question.id }}" value="{{ forloop.counter0 }}" 
              class="mr-3 w-5 h-5 text-primary" onchange="{{ on_answer_change }}">
            <span>{{ option }}</span>
          </label>
          {% endfor %}
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<!-- Results Modal -->
<div id="{{ component_id }}-results-modal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
  <div class="bg-surface rounded-2xl shadow-2xl max-w-md w-full p-8">
    <div id="{{ component_id }}-results-content">
      <!-- Results will be dynamically inserted here -->
    </div>
  </div>
</div>
